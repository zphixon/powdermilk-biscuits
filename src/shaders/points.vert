#version 430

vec3 verts[73] = vec3[73](
  vec3(1.2636809, -1.6906081, 0.19335938),
  vec3(1.2628158, -1.6845526, 0.20605469),
  vec3(1.2622391, -1.6783239, 0.20605469),
  vec3(1.2622391, -1.6722683, 0.20605469),
  vec3(1.2622391, -1.6660397, 0.21289063),
  vec3(1.2622391, -1.6599841, 0.2265625),
  vec3(1.2622391, -1.6546206, 0.2265625),
  vec3(1.2636809, -1.6497762, 0.2265625),
  vec3(1.2651228, -1.6454507, 0.2265625),
  vec3(1.2671412, -1.6419904, 0.23242188),
  vec3(1.2700248, -1.6392221, 0.25585938),
  vec3(1.2746387, -1.6380111, 0.25585938),
  vec3(1.2798291, -1.637492, 0.25585938),
  vec3(1.2861731, -1.638357, 0.3076172),
  vec3(1.2965541, -1.6423364, 0.3076172),
  vec3(1.3170277, -1.6534095, 0.3076172),
  vec3(1.3426919, -1.6726143, 0.3076172),
  vec3(1.3674909, -1.6959716, 0.34179688),
  vec3(1.3925784, -1.7222701, 0.34179688),
  vec3(1.4173774, -1.753067, 0.37402344),
  vec3(1.4436182, -1.7861133, 0.37402344),
  vec3(1.4715892, -1.8212355, 0.4169922),
  vec3(1.4986951, -1.8594723, 0.4169922),
  vec3(1.524936, -1.898055, 0.4169922),
  vec3(1.5514653, -1.9380219, 0.4326172),
  vec3(1.5771294, -1.9762585, 0.49023438),
  vec3(1.6033703, -2.012419, 0.49023438),
  vec3(1.6298994, -2.0458112, 0.49023438),
  vec3(1.657582, -2.0760891, 0.49023438),
  vec3(1.6841114, -2.1029067, 0.50390625),
  vec3(1.7112173, -2.1253989, 0.54003906),
  vec3(1.7383232, -2.1454687, 0.54003906),
  vec3(1.7660059, -2.1625974, 0.54003906),
  vec3(1.7873446, -2.1728053, 0.5800781),
  vec3(1.8202177, -2.1859546, 0.5800781),
  vec3(1.8444401, -2.1933944, 0.5800781),
  vec3(1.8801967, -2.2022183, 0.5800781),
  vec3(1.905861, -2.2061975, 0.5966797),
  vec3(1.9352739, -2.2084467, 0.5966797),
  vec3(1.9776628, -2.2105231, 0.6230469),
  vec3(2.0085175, -2.2105231, 0.6230469),
  vec3(2.054655, -2.2084467, 0.6230469),
  vec3(2.0984862, -2.2039483, 0.6503906),
  vec3(2.1417403, -2.197893, 0.6503906),
  vec3(2.1855712, -2.1902802, 0.6503906),
  vec3(2.2282486, -2.1811101, 0.6582031),
  vec3(2.2715027, -2.1705563, 0.67871094),
  vec3(2.3144686, -2.1596563, 0.67871094),
  vec3(2.356281, -2.146334, 0.67871094),
  vec3(2.3980932, -2.1323195, 0.6845703),
  vec3(2.4404824, -2.116056, 0.6982422),
  vec3(2.4831598, -2.0985813, 0.6982422),
  vec3(2.5255487, -2.0809336, 0.6982422),
  vec3(2.567361, -2.0624208, 0.70214844),
  vec3(2.6097503, -2.041832, 0.7109375),
  vec3(2.6521392, -2.0221078, 0.7109375),
  vec3(2.6939516, -2.0004807, 0.7109375),
  vec3(2.734322, -1.9772966, 0.71484375),
  vec3(2.7761345, -1.9525553, 0.71484375),
  vec3(2.8176584, -1.9271218, 0.71972656),
  vec3(2.858894, -1.9011692, 0.71972656),
  vec3(2.8975346, -1.8731407, 0.71972656),
  vec3(2.936463, -1.8423438, 0.71875),
  vec3(2.9797175, -1.8092974, 0.6972656),
  vec3(3.0221064, -1.77331, 0.6972656),
  vec3(3.0653608, -1.7342082, 0.6972656),
  vec3(3.1100566, -1.6916462, 0.5683594),
  vec3(3.1533108, -1.6457968, 0.5683594),
  vec3(3.1971414, -1.5961411, 0.5683594),
  vec3(3.2403958, -1.5461392, 0.5683594),
  vec3(3.2799013, -1.4959644, 0.37890625),
  vec3(3.3217137, -1.4468277, 0.16796875),
  vec3(3.3568938, -1.3975179, 0.16796875)
);

layout (location=0) in vec2 strokePos;
layout (location=1) in float pressure;

layout (location=0) uniform vec2 sip;
layout (location=1) uniform float zoom;
layout (location=2) uniform float heightOverWidth;
layout (location=3) uniform float drawOrigin;

layout (location=0) out vec2 fragPos;
layout (location=1) out float fragPressure;
layout (location=2) out float fragDrawOrigin;

void main() {
  fragDrawOrigin = drawOrigin;
  if (drawOrigin > 0.5) {
    fragPos = sip;
    gl_Position = vec4(sip, 0.0, 1.0);
  } else {
    vec2 diff = verts[gl_VertexID].xy - sip;
    vec2 pos = vec2(
      zoom * diff.x,
      zoom * diff.y * heightOverWidth
    );
    fragPos = pos;
    gl_Position = vec4(pos, 0.0, 1.0);
    gl_PointSize = verts[gl_VertexID].z * 20;
  }
  fragPressure = verts[gl_VertexID].z;
}
